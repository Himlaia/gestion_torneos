<?xml version="1.0" encoding="UTF-8"?>
<!-- Plantilla JasperReports: Partidos y Resultados -->
<!-- Abre con JasperSoft Studio para editar visualmente -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports
                http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="partidos_resultados"
              pageWidth="842" pageHeight="595" orientation="Landscape"
              columnWidth="802"
              leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20"
              uuid="b2c3d4e5-f6a7-8901-bcde-f12345678901">

    <property name="com.jaspersoft.studio.data.defaultdataadapter" value="torneo_sqlite"/>

    <parameter name="eliminatoria" class="java.lang.String" isForPrompting="true">
        <parameterDescription><![CDATA[Fase del torneo (null = todas)]]></parameterDescription>
    </parameter>

    <queryString language="SQL">
        <![CDATA[
            SELECT p.slot,
                   COALESCE(el.nombre, '(Por definir)') AS equipo_local,
                   COALESCE(p.goles_local, '-') AS goles_local,
                   COALESCE(p.goles_visitante, '-') AS goles_visitante,
                   COALESCE(ev.nombre, '(Por definir)') AS equipo_visitante,
                   COALESCE(ar.nombre || ' ' || ar.apellidos, '-') AS arbitro,
                   COALESCE(p.fecha_hora, '-') AS fecha_hora,
                   p.penaltis_local, p.penaltis_visitante,
                   p.estado, p.eliminatoria
            FROM partidos p
            LEFT JOIN equipos el ON p.equipo_local_id = el.id
            LEFT JOIN equipos ev ON p.equipo_visitante_id = ev.id
            LEFT JOIN participantes ar ON p.arbitro_id = ar.id
            WHERE ($P{eliminatoria} IS NULL OR p.eliminatoria = $P{eliminatoria})
            ORDER BY
                CASE p.eliminatoria
                    WHEN 'octavos' THEN 1 WHEN 'cuartos' THEN 2
                    WHEN 'semifinal' THEN 3 WHEN 'final' THEN 4
                    ELSE 5
                END,
                p.slot
        ]]>
    </queryString>

    <field name="slot" class="java.lang.Integer"/>
    <field name="equipo_local" class="java.lang.String"/>
    <field name="goles_local" class="java.lang.String"/>
    <field name="goles_visitante" class="java.lang.String"/>
    <field name="equipo_visitante" class="java.lang.String"/>
    <field name="arbitro" class="java.lang.String"/>
    <field name="fecha_hora" class="java.lang.String"/>
    <field name="penaltis_local" class="java.lang.Integer"/>
    <field name="penaltis_visitante" class="java.lang.Integer"/>
    <field name="estado" class="java.lang.String"/>
    <field name="eliminatoria" class="java.lang.String"/>

    <group name="GrupoEliminatoria">
        <groupExpression><![CDATA[$F{eliminatoria}]]></groupExpression>
    </group>

    <title>
        <band height="50">
            <staticText>
                <reportElement x="0" y="0" width="802" height="40"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="SansSerif" size="18" isBold="true"/>
                </textElement>
                <text><![CDATA[Informe de Partidos y Resultados]]></text>
            </staticText>
        </band>
    </title>

    <columnHeader>
        <band height="25">
            <staticText>
                <reportElement mode="Opaque" x="0" y="0" width="40" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Slot]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="40" y="0" width="160" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Equipo Local]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="200" y="0" width="50" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Goles]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="250" y="0" width="50" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Goles]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="300" y="0" width="160" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Equipo Visitante]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="460" y="0" width="130" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Árbitro]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="590" y="0" width="110" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Fecha]]></text>
            </staticText>
            <staticText>
                <reportElement mode="Opaque" x="700" y="0" width="102" height="25" backcolor="#2C3E50" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font isBold="true" size="8"/></textElement>
                <text><![CDATA[Estado]]></text>
            </staticText>
        </band>
    </columnHeader>

    <detail>
        <band height="20">
            <textField>
                <reportElement x="0" y="0" width="40" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{slot}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="40" y="0" width="160" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{equipo_local}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="200" y="0" width="50" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{goles_local}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="250" y="0" width="50" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{goles_visitante}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="300" y="0" width="160" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{equipo_visitante}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="460" y="0" width="130" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{arbitro}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="590" y="0" width="110" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{fecha_hora}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="700" y="0" width="102" height="20"/>
                <textElement textAlignment="Center" verticalAlignment="Middle"><font size="8"/></textElement>
                <textFieldExpression><![CDATA[$F{estado}]]></textFieldExpression>
            </textField>
        </band>
    </detail>

    <pageFooter>
        <band height="25">
            <textField>
                <reportElement x="0" y="0" width="802" height="20"/>
                <textElement textAlignment="Center"><font size="8"/></textElement>
                <textFieldExpression><![CDATA["Página " + $V{PAGE_NUMBER} + " de " + $V{PAGE_COUNT}]]></textFieldExpression>
            </textField>
        </band>
    </pageFooter>
</jasperReport>
